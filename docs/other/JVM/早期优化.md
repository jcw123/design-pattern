# 程序编译与代码优化

一、编译三个过程：
1、解析和填充符号表过程
2、插入式注解处理器的注解处理过程
3、分析和字节码生成过程


二、解析和填充符号表过程
1、词法分析、语法分析阶段
词法分析是将源代码的字符流转变为标记（TOKEN）集合
语法分析是根据TOKEN序列构造抽象语法树过程

2、填充符号表
在语义分析过程中，符号表所登记的内容用于语义检查和产生中间代码。

三、注解处理器
1.6版本提供了一组插入式注解处理器的标准API在编译期间对注解进行处理，可以看做是编译器的插件。

四、语义分析和字节码生成
1、标注检查
检查的内容包括：诸如变量使用之前是否声明、变量与赋值之间的数据类型是否匹配等等。
2、数据及控制流分析
对程序的上下文进一步的验证，可以检查诸如程序变量在使用前是否赋值、方法的每条路径是否有返回值、是否所有的受查异常都被正确处理等。
3、解语法糖
主要的语法糖：泛型、变长参数、自动装箱/拆箱等，运行时并不支持这些语法糖，在编译器就还原回原来的语法结构，称之为解语法糖。
4、字节码生成
在这个阶段会生成<init>和<clinit>方法，这是一个代码收敛过程。


# Java语法糖的味道

一、泛型与类型擦除
本质上是参数化类型的应用，java中的泛型是一种伪泛型。擦除是在方法的Code属性上进行擦除，实际上元数据上还保留了泛型信息。

二、自动装箱、拆箱与遍历循环
foreach循环会在编译之后生成Iterator格式的循环语句
三、条件编译
使用条件为常量的if语句达到条件编译，编译之后会消除不可达的分支语句。
